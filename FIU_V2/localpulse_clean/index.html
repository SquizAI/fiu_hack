<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalPulse - Coral Gables AI Dashboard</title>
    
    <!-- CSS Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Mapbox GL JS -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    
    <!-- Leaflet (required for Windy API) -->
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
    
    <!-- Windy API -->
    <script src="https://api.windy.com/assets/map-forecast/libBoot.js"></script>
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #0066cc;
            --secondary-color: #28a745;
            --dark-color: #1a1a1a;
            --light-color: #f8f9fa;
            --accent-color: #ffc107;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-color);
            color: var(--dark-color);
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 1.5rem;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .metric-number {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: white !important;
        }

        .metric-label {
            font-size: clamp(0.8rem, 2vw, 1rem);
            opacity: 0.9;
            color: white !important;
        }

        .sidebar {
            background: white;
            min-height: calc(100vh - 76px);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .nav-link {
            color: var(--dark-color);
            border-radius: 10px;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .nav-link:hover, .nav-link.active {
            background-color: var(--primary-color);
            color: white;
        }

        .content-area {
            margin-top: 1rem;
        }

        .map-container {
            height: 600px;
            border-radius: 15px;
            overflow: hidden;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 2rem;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .status-active { background-color: #28a745; }
        .status-warning { background-color: #ffc107; }
        .status-error { background-color: #dc3545; }

        .data-source-card {
            border-left: 4px solid var(--primary-color);
        }

        .loading-spinner {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 10px;
        }

        .alert {
            border-radius: 10px;
            border: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .metric-card .metric-number {
                font-size: 1.8rem !important;
                line-height: 1.2 !important;
            }
            
            .metric-card .metric-label {
                font-size: 0.75rem !important;
                line-height: 1.1 !important;
            }
            
            .metric-card .card-body {
                padding: 0.75rem !important;
            }
            
            .col-md-2 {
                flex: 0 0 50% !important;
                max-width: 50% !important;
            }
            
            .form-select-sm {
                font-size: 0.8rem;
            }
            
            /* Prevent card stretching */
            .metric-card {
                min-height: 100px !important;
                max-height: 120px !important;
            }
            
            /* Responsive text sizing */
            .h4 {
                font-size: 1.2rem !important;
            }
            
            .h5 {
                font-size: 1rem !important;
            }
            
            /* Map responsive height */
            .map-container {
                height: 350px !important;
            }
        }
        
        @media (max-width: 576px) {
            .col-md-2 {
                flex: 0 0 100% !important;
                max-width: 100% !important;
            }
            
            .metric-card .metric-number {
                font-size: 1.5rem !important;
            }
            
            .metric-card .metric-label {
                font-size: 0.7rem !important;
            }
        }

        /* Fix text color issues */
        .text-dark {
            color: #212529 !important;
        }

        .card-title, .card-text, .card-header h5, .card-header h6 {
            color: #212529 !important;
        }

        .list-group-item {
            color: #212529 !important;
        }

        .alert {
            color: #212529 !important;
        }

        .badge {
            color: white !important;
        }

        /* Ensure proper contrast */
        .bg-light {
            background-color: #f8f9fa !important;
            color: #212529 !important;
        }

        .bg-white {
            background-color: #ffffff !important;
            color: #212529 !important;
        }

        /* Fix metric card text visibility */
        .metric-card {
            color: white !important;
            border: none !important;
        }

        .metric-card .metric-number,
        .metric-card .metric-label,
        .metric-card small,
        .metric-card .card-body,
        .metric-card .card-body * {
            color: white !important;
        }

        .metric-card .text-white {
            color: white !important;
        }

        /* Fix card body text */
        .card-body {
            color: #212529 !important;
        }

        .card-body h4, .card-body h5, .card-body h6 {
            color: #212529 !important;
        }

        .card-body small {
            color: #6c757d !important;
        }

        /* Mobile Navigation Styles */
        .mobile-nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            display: flex;
            flex-direction: column;
        }

        .mobile-nav-content {
            background: var(--primary-color);
            height: 100%;
            padding: 1rem;
            overflow-y: auto;
        }

        .mobile-nav-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 2rem;
            color: white;
        }

        .mobile-nav-header .btn-close {
            filter: invert(1);
        }

        .mobile-nav-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .mobile-nav-link {
            display: flex;
            align-items: center;
            padding: 1rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .mobile-nav-link:hover,
        .mobile-nav-link.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
        }

        .mobile-nav-link i {
            margin-right: 0.75rem;
            width: 20px;
        }

        /* Hide navbar toggler on desktop */
        @media (min-width: 992px) {
            .navbar-toggler {
                display: none !important;
            }
        }

        /* Mobile optimizations */
        @media (max-width: 991px) {
            .container-fluid {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            .content-area {
                margin-top: 0.5rem;
            }
            
            .metric-card {
                margin-bottom: 1rem;
                min-height: 80px;
            }
            
            .metric-number {
                font-size: 1.5rem;
            }
            
            .metric-label {
                font-size: 0.8rem;
            }
            
            .card-header {
                padding: 0.75rem;
            }
            
            .card-body {
                padding: 0.75rem;
            }
            
            .btn-group-sm .btn {
                font-size: 0.7rem;
                padding: 0.2rem 0.4rem;
            }
        }

        @media (max-width: 576px) {
            .navbar-brand {
                font-size: 1rem;
            }
            
            .metric-card {
                min-height: 70px;
                padding: 0.5rem;
            }
            
            .metric-number {
                font-size: 1.2rem;
            }
            
            .metric-label {
                font-size: 0.7rem;
            }
            
            .map-container {
                height: 300px;
            }
            
            .chart-container {
                height: 200px;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .btn-group {
                flex-wrap: wrap;
            }
            
            .form-select-sm {
                font-size: 0.8rem;
            }
        }

        /* AI Analysis Popup Styles */
        .analysis-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10000;
            max-width: 700px;
            max-height: 85vh;
            overflow-y: auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: none;
        }

        .analysis-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .analysis-header h5 {
            margin: 0;
            font-weight: 600;
            color: white !important;
        }

        .analysis-header .btn-close {
            filter: invert(1);
            opacity: 0.8;
        }

        .analysis-header .btn-close:hover {
            opacity: 1;
        }

        .analysis-content {
            padding: 2rem;
            background: white;
            color: #212529;
        }

        .analysis-summary {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .analysis-summary h6 {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .analysis-summary p {
            margin: 0;
            color: #495057;
            line-height: 1.6;
        }

        .analysis-insights, 
        .analysis-recommendations {
            margin-bottom: 1.5rem;
        }

        .analysis-insights h6,
        .analysis-recommendations h6 {
            color: #495057;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }

        .analysis-insights h6:before,
        .analysis-recommendations h6:before {
            content: "🔍";
            margin-right: 0.5rem;
        }

        .analysis-recommendations h6:before {
            content: "💡";
        }

        .analysis-insights ul,
        .analysis-recommendations ul {
            list-style: none;
            padding: 0;
        }

        .analysis-insights li,
        .analysis-recommendations li {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #28a745;
            color: #495057;
        }

        .analysis-footer {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid #dee2e6;
            background: #f8f9fa;
            border-radius: 0 0 10px 10px;
            margin-left: -2rem;
            margin-right: -2rem;
            margin-bottom: -2rem;
            padding-left: 2rem;
            padding-right: 2rem;
            padding-bottom: 1.5rem;
        }

        .analysis-footer .badge {
            font-size: 0.875rem;
            padding: 0.5rem 1rem;
        }

        .analysis-footer small {
            color: #6c757d;
        }

        /* Mobile responsive for analysis popup */
        @media (max-width: 768px) {
            .analysis-popup {
                max-width: 95vw;
                max-height: 90vh;
                margin: 1rem;
                top: 5%;
                left: 50%;
                transform: translateX(-50%);
            }

            .analysis-header {
                padding: 1rem;
            }

            .analysis-content {
                padding: 1.5rem;
            }

            .analysis-footer {
                margin-left: -1.5rem;
                margin-right: -1.5rem;
                padding-left: 1.5rem;
                padding-right: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-geo-alt-fill"></i> LocalPulse
            </a>
            
            <!-- Mobile hamburger button -->
            <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#mobileNav" aria-controls="mobileNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <!-- Desktop title -->
            <span class="navbar-text text-white d-none d-lg-block">
                Coral Gables AI for Good Dashboard
            </span>
        </div>
    </nav>
    
    <!-- Mobile Navigation Overlay -->
    <div class="collapse navbar-collapse d-lg-none" id="mobileNav">
        <div class="mobile-nav-overlay">
            <div class="mobile-nav-content">
                <div class="mobile-nav-header">
                    <h5><i class="bi bi-list"></i> Navigation</h5>
                    <button type="button" class="btn-close" data-bs-toggle="collapse" data-bs-target="#mobileNav"></button>
                </div>
                <nav class="mobile-nav-links">
                    <a class="mobile-nav-link active" href="#" data-section="dashboard">
                        <i class="bi bi-speedometer2"></i> Dashboard
                    </a>
                    <a class="mobile-nav-link" href="#" data-section="crime">
                        <i class="bi bi-shield-exclamation"></i> Crime Analysis
                    </a>
                    <a class="mobile-nav-link" href="#" data-section="traffic">
                        <i class="bi bi-car-front"></i> Traffic Analysis
                    </a>
                    <a class="mobile-nav-link" href="#" data-section="social">
                        <i class="bi bi-chat-dots"></i> Social Media
                    </a>
                    <a class="mobile-nav-link" href="#" data-section="vehicle-detection">
                        <i class="bi bi-camera-video"></i> Vehicle Detection
                    </a>
                    <a class="mobile-nav-link" href="#" data-section="data-integration">
                        <i class="bi bi-database"></i> Data Integration
                    </a>
                    <a class="mobile-nav-link" href="#" data-section="weather">
                        <i class="bi bi-cloud-sun"></i> Weather
                    </a>
                    <a class="mobile-nav-link" href="#" data-section="data-sources">
                        <i class="bi bi-info-circle"></i> Data Sources
                    </a>
                </nav>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">
            <!-- Desktop Sidebar (hidden on mobile) -->
            <div class="col-md-3 d-none d-lg-block">
                <div class="sidebar">
                    <h5 class="mb-3"><i class="bi bi-list"></i> Navigation</h5>
                    <nav class="nav flex-column">
                        <a class="nav-link active" href="#" data-section="dashboard">
                            <i class="bi bi-speedometer2"></i> Dashboard
                        </a>
                        <a class="nav-link" href="#" data-section="crime">
                            <i class="bi bi-shield-exclamation"></i> Crime Analysis
                        </a>
                        <a class="nav-link" href="#" data-section="traffic">
                            <i class="bi bi-car-front"></i> Traffic Analysis
                        </a>
                        <a class="nav-link" href="#" data-section="social">
                            <i class="bi bi-chat-dots"></i> Social Media
                        </a>
                        <a class="nav-link" href="#" data-section="vehicle-detection">
                            <i class="bi bi-camera-video"></i> Vehicle Detection
                        </a>
                        <a class="nav-link" href="#" data-section="data-integration">
                            <i class="bi bi-database"></i> Data Integration
                        </a>
                        <a class="nav-link" href="#" data-section="weather">
                            <i class="bi bi-cloud-sun"></i> Weather
                        </a>
                        <a class="nav-link" href="#" data-section="data-sources">
                            <i class="bi bi-info-circle"></i> Data Sources
                        </a>
                    </nav>

                    <!-- API Status -->
                    <div class="mt-4">
                        <h6><i class="bi bi-wifi"></i> API Status</h6>
                        <div id="api-status">
                            <div class="d-flex align-items-center mb-2">
                                <span class="status-indicator status-active"></span>
                                <small>Mapbox Maps</small>
                            </div>
                            <div class="d-flex align-items-center mb-2">
                                <span class="status-indicator status-warning"></span>
                                <small>Miami-Dade Data</small>
                            </div>
                            <div class="d-flex align-items-center mb-2">
                                <span class="status-indicator status-active"></span>
                                <small>FDOT Traffic</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 col-12">
                <div class="content-area">
                    <!-- Dashboard Section -->
                    <div id="dashboard-section" class="content-section">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2><i class="bi bi-speedometer2"></i> Coral Gables Command Center</h2>
                            <div class="d-flex gap-2">
                                <select class="form-select form-select-sm" id="dashboard-timeframe" style="width: auto;">
                                    <option value="live">Live Data</option>
                                    <option value="24h">Last 24 Hours</option>
                                    <option value="7d">Last 7 Days</option>
                                    <option value="30d">Last 30 Days</option>
                                </select>
                                <select class="form-select form-select-sm" id="dashboard-view" style="width: auto;">
                                    <option value="overview">Overview</option>
                                    <option value="safety">Public Safety</option>
                                    <option value="infrastructure">Infrastructure</option>
                                    <option value="environment">Environment</option>
                                    <option value="economic">Economic</option>
                                </select>
                                <button class="btn btn-outline-primary btn-sm" id="export-dashboard">
                                    <i class="bi bi-download"></i> Export
                                </button>
                            </div>
                        </div>

                        <!-- Alert Banner -->
                        <div id="alert-banner" class="alert alert-warning alert-dismissible fade show mb-4" style="display: none;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                                <div>
                                    <strong>Active Alert:</strong> <span id="alert-message"></span>
                                    <small class="d-block text-muted" id="alert-time"></small>
                                </div>
                            </div>
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>

                        <!-- Key Performance Indicators -->
                        <div class="row mb-4">
                            <div class="col-md-2 mb-3">
                                <div class="card metric-card text-white" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); border: none;">
                                    <div class="card-body text-center">
                                        <div class="metric-number text-white" id="emergency-calls">12</div>
                                        <div class="metric-label text-white">Active 911 Calls</div>
                                        <small class="mt-1 opacity-75 text-white" id="emergency-trend">↑ 2 from last hour</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card metric-card text-white" style="background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%); border: none;">
                                    <div class="card-body text-center">
                                        <div class="metric-number text-white" id="response-time">4.2</div>
                                        <div class="metric-label text-white">Avg Response (min)</div>
                                        <small class="mt-1 opacity-75 text-white" id="response-trend">↓ 0.8 from yesterday</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card metric-card text-white" style="background: linear-gradient(135deg, #45b7d1 0%, #2980b9 100%); border: none;">
                                    <div class="card-body text-center">
                                        <div class="metric-number text-white" id="traffic-flow">89%</div>
                                        <div class="metric-label text-white">Traffic Flow</div>
                                        <small class="mt-1 opacity-75 text-white" id="traffic-trend">Normal conditions</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card metric-card text-white" style="background: linear-gradient(135deg, #96ceb4 0%, #85b79d 100%); border: none;">
                                    <div class="card-body text-center">
                                        <div class="metric-number text-white" id="air-quality">42</div>
                                        <div class="metric-label text-white">Air Quality (AQI)</div>
                                        <small class="mt-1 opacity-75 text-white" id="air-trend">Good quality</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card metric-card text-white" style="background: linear-gradient(135deg, #f9ca24 0%, #f39c12 100%); border: none;">
                                    <div class="card-body text-center">
                                        <div class="metric-number text-white" id="power-status">99.8%</div>
                                        <div class="metric-label text-white">Grid Uptime</div>
                                        <small class="mt-1 opacity-75 text-white" id="power-trend">All systems normal</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card metric-card text-white" style="background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%); border: none;">
                                    <div class="card-body text-center">
                                        <div class="metric-number text-white" id="water-quality">A+</div>
                                        <div class="metric-label text-white">Water Quality</div>
                                        <small class="mt-1 opacity-75 text-white" id="water-trend">Excellent</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Main Dashboard Grid -->
                        <div class="row">
                            <!-- Real-time Map -->
                            <div class="col-md-8 mb-4">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5><i class="bi bi-map"></i> Live City Overview</h5>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <input type="checkbox" class="btn-check" id="show-crime" checked autocomplete="off">
                                            <label class="btn btn-outline-danger" for="show-crime">Crime</label>
                                            
                                            <input type="checkbox" class="btn-check" id="show-traffic" checked autocomplete="off">
                                            <label class="btn btn-outline-warning" for="show-traffic">Traffic</label>
                                            
                                            <input type="checkbox" class="btn-check" id="show-emergency" checked autocomplete="off">
                                            <label class="btn btn-outline-primary" for="show-emergency">Emergency</label>
                                            
                                            <input type="checkbox" class="btn-check" id="show-construction" autocomplete="off">
                                            <label class="btn btn-outline-secondary" for="show-construction">Construction</label>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <div id="main-map" class="map-container"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Live Activity Feed -->
                            <div class="col-md-4 mb-4">
                                <div class="card h-100">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5><i class="bi bi-activity"></i> Live Activity</h5>
                                        <button class="btn btn-outline-primary btn-sm" id="activity-filters">
                                            <i class="bi bi-funnel"></i>
                                        </button>
                                    </div>
                                    <div class="card-body p-0">
                                        <div id="activity-feed" class="list-group list-group-flush" style="max-height: 350px; overflow-y: auto;">
                                            <!-- Live activity items will be populated here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Secondary Metrics Row -->
                        <div class="row">
                            <!-- Public Safety Overview -->
                            <div class="col-md-3 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6><i class="bi bi-shield-check"></i> Public Safety</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row text-center">
                                            <div class="col-6 mb-3">
                                                <div class="h4 text-primary" id="police-units">18</div>
                                                <small>Police Units</small>
                                            </div>
                                            <div class="col-6 mb-3">
                                                <div class="h4 text-success" id="fire-units">6</div>
                                                <small>Fire Units</small>
                                            </div>
                                            <div class="col-6 mb-3">
                                                <div class="h4 text-warning" id="ems-units">4</div>
                                                <small>EMS Units</small>
                                            </div>
                                            <div class="col-6 mb-3">
                                                <div class="h4 text-info" id="available-units">12</div>
                                                <small>Available</small>
                                            </div>
                                        </div>
                                        <div class="chart-container" style="height: 150px;">
                                            <canvas id="safety-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Infrastructure Status -->
                            <div class="col-md-3 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6><i class="bi bi-gear"></i> Infrastructure</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>Power Grid</small>
                                                <small class="text-success">99.8%</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: 99.8%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>Water System</small>
                                                <small class="text-success">100%</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: 100%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>Internet/Cellular</small>
                                                <small class="text-warning">94.2%</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-warning" style="width: 94.2%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>Traffic Signals</small>
                                                <small class="text-success">98.1%</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: 98.1%"></div>
                                            </div>
                                        </div>
                                        <div class="chart-container" style="height: 120px;">
                                            <canvas id="infrastructure-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Environmental Monitoring -->
                            <div class="col-md-3 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6><i class="bi bi-tree"></i> Environment</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row text-center mb-3">
                                            <div class="col-6">
                                                <div class="h5 text-success">42</div>
                                                <small>AQI</small>
                                            </div>
                                            <div class="col-6">
                                                <div class="h5 text-info">52dB</div>
                                                <small>Noise</small>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <small class="text-muted">Weather Conditions</small>
                                            <div class="d-flex justify-content-between">
                                                <span>Temperature</span>
                                                <span id="current-temp">78°F</span>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Humidity</span>
                                                <span id="current-humidity">65%</span>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Wind</span>
                                                <span id="current-wind">12 mph</span>
                                            </div>
                                        </div>
                                        <div class="chart-container" style="height: 120px;">
                                            <canvas id="environment-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Economic Indicators -->
                            <div class="col-md-3 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6><i class="bi bi-graph-up"></i> Economic</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row text-center mb-3">
                                            <div class="col-6">
                                                <div class="h5 text-primary">$2.4M</div>
                                                <small>Daily Revenue</small>
                                            </div>
                                            <div class="col-6">
                                                <div class="h5 text-success">847</div>
                                                <small>Permits</small>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <small class="text-muted">Business Activity</small>
                                            <div class="d-flex justify-content-between">
                                                <span>Tourism</span>
                                                <span class="text-success">↑ 12%</span>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Parking</span>
                                                <span class="text-info">78%</span>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Transit</span>
                                                <span class="text-warning">↓ 3%</span>
                                            </div>
                                        </div>
                                        <div class="chart-container" style="height: 120px;">
                                            <canvas id="economic-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Analytics Row -->
                        <div class="row">
                            <!-- Trend Analysis -->
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6><i class="bi bi-graph-up-arrow"></i> Trend Analysis</h6>
                                        <select class="form-select form-select-sm" id="trend-metric" style="width: auto;">
                                            <option value="crime">Crime Incidents</option>
                                            <option value="traffic">Traffic Volume</option>
                                            <option value="emergency">Emergency Calls</option>
                                            <option value="revenue">City Revenue</option>
                                        </select>
                                    </div>
                                    <div class="card-body">
                                        <div class="chart-container" style="height: 250px;">
                                            <canvas id="trend-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Predictive Analytics -->
                            <div class="col-md-6 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6><i class="bi bi-cpu"></i> AI Insights & Predictions</h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="ai-insights" class="mb-3">
                                            <!-- AI insights will be populated here -->
                                        </div>
                                        <div class="chart-container" style="height: 200px;">
                                            <canvas id="prediction-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Crime Analysis Section -->
                    <div id="crime-section" class="content-section" style="display: none;">
                        <h2 class="mb-4"><i class="bi bi-shield-exclamation"></i> Crime Analysis</h2>
                        
                        <div class="row">
                            <div class="col-md-8 mb-4">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5>Crime Incidents Map - REAL DATA</h5>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <input type="checkbox" class="btn-check" id="crime-show-crime" checked autocomplete="off">
                                            <label class="btn btn-outline-danger" for="crime-show-crime">Crime</label>
                                            
                                            <input type="checkbox" class="btn-check" id="crime-show-traffic" autocomplete="off">
                                            <label class="btn btn-outline-warning" for="crime-show-traffic">Traffic Context</label>
                                            
                                            <input type="checkbox" class="btn-check" id="crime-show-emergency" checked autocomplete="off">
                                            <label class="btn btn-outline-primary" for="crime-show-emergency">Emergency</label>
                                            
                                            <input type="checkbox" class="btn-check" id="crime-show-heatmap" checked autocomplete="off">
                                            <label class="btn btn-outline-secondary" for="crime-show-heatmap">Heatmap</label>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <div id="crime-map" class="map-container"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>Real-Time Crime Statistics</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row text-center mb-3">
                                            <div class="col-6">
                                                <div class="h4 text-danger" id="total-crimes">Loading...</div>
                                                <small>Total Incidents</small>
                                            </div>
                                            <div class="col-6">
                                                <div class="h4 text-warning" id="active-crimes">Loading...</div>
                                                <small>Active Cases</small>
                                            </div>
                                        </div>
                                        <div class="chart-container">
                                            <canvas id="crime-chart"></canvas>
                                        </div>
                                        <div class="mt-3">
                                            <button class="btn btn-primary btn-sm w-100" id="ai-crime-analysis">
                                                <i class="fas fa-brain"></i> AI Crime Analysis
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Traffic Analysis Section -->
                    <div id="traffic-section" class="content-section" style="display: none;">
                        <h2 class="mb-4"><i class="bi bi-car-front"></i> Traffic Analysis</h2>
                        
                        <div class="row">
                            <div class="col-md-8 mb-4">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5>Traffic Flow Map - REAL DATA</h5>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <input type="checkbox" class="btn-check" id="traffic-show-traffic" checked autocomplete="off">
                                            <label class="btn btn-outline-warning" for="traffic-show-traffic">Traffic</label>
                                            
                                            <input type="checkbox" class="btn-check" id="traffic-show-crime" autocomplete="off">
                                            <label class="btn btn-outline-danger" for="traffic-show-crime">Crime Context</label>
                                            
                                            <input type="checkbox" class="btn-check" id="traffic-show-emergency" checked autocomplete="off">
                                            <label class="btn btn-outline-primary" for="traffic-show-emergency">Emergency</label>
                                            
                                            <input type="checkbox" class="btn-check" id="traffic-show-routes" checked autocomplete="off">
                                            <label class="btn btn-outline-info" for="traffic-show-routes">Flow Lines</label>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <div id="traffic-map" class="map-container"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>Real-Time Traffic Statistics</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row text-center mb-3">
                                            <div class="col-6">
                                                <div class="h4 text-warning" id="total-incidents">Loading...</div>
                                                <small>Traffic Incidents</small>
                                            </div>
                                            <div class="col-6">
                                                <div class="h4 text-info" id="avg-speed">Loading...</div>
                                                <small>Avg Speed (mph)</small>
                                            </div>
                                        </div>
                                        <div class="chart-container">
                                            <canvas id="traffic-chart"></canvas>
                                        </div>
                                        <div class="mt-3">
                                            <button class="btn btn-primary btn-sm w-100" id="ai-traffic-analysis">
                                                <i class="fas fa-brain"></i> AI Traffic Analysis
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vehicle Detection Section -->
                    <div id="vehicle-detection-section" class="content-section" style="display: none;">
                        <h2 class="mb-4"><i class="bi bi-car-front"></i> AI Vehicle Detection</h2>
                        
                        <!-- Token Management -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="card border-warning">
                                    <div class="card-header bg-warning bg-opacity-10">
                                        <h6 class="mb-0"><i class="bi bi-key-fill"></i> FL511 Camera Token Management</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row align-items-center">
                                            <div class="col-md-8">
                                                <div class="mb-2">
                                                    <label for="token-input" class="form-label small">FL511 Camera Stream Tokens (comma-separated):</label>
                                                    <textarea class="form-control form-control-sm" id="token-input" rows="2" 
                                                              placeholder="Enter FL511 tokens here, separated by commas..."></textarea>
                                                    <div class="form-text">
                                                        Tokens expire periodically. Get new tokens from FL511 camera network inspector.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="d-grid gap-2">
                                                    <button class="btn btn-warning btn-sm" id="update-tokens">
                                                        <i class="bi bi-arrow-clockwise"></i> Update Tokens
                                                    </button>
                                                    <button class="btn btn-outline-info btn-sm" id="test-tokens">
                                                        <i class="bi bi-check-circle"></i> Test Tokens
                                                    </button>
                                                </div>
                                                <div class="mt-2">
                                                    <small class="text-muted">
                                                        <span id="token-status" class="badge bg-secondary">Not Set</span>
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mt-2">
                                            <div class="alert alert-warning alert-sm mb-0">
                                                <small>
                                                    <i class="bi bi-exclamation-triangle"></i> 
                                                    <strong>FL511 tokens expire frequently!</strong> To get fresh tokens:
                                                    <br>1. Go to <a href="https://fl511.com" target="_blank">FL511.com</a>
                                                    <br>2. Click on a traffic camera
                                                    <br>3. Open Developer Tools (F12) → Network tab
                                                    <br>4. Look for .m3u8 requests and copy the token parameter
                                                    <br>5. Paste tokens here (comma-separated for multiple cameras)
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8 mb-4">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5>Live Traffic Camera Feed</h5>
                                        <div class="d-flex gap-2">
                                            <select class="form-select form-select-sm" id="camera-select" style="width: 200px;">
                                                <option value="">Select Camera Feed</option>
                                            </select>
                                            <button class="btn btn-success btn-sm" id="start-detection">
                                                <i class="bi bi-play-fill"></i> Start Detection
                                            </button>
                                            <button class="btn btn-danger btn-sm" id="stop-detection" disabled>
                                                <i class="bi bi-stop-fill"></i> Stop
                                            </button>
                                            <button class="btn btn-info btn-sm" id="debug-detection" title="Debug Info">
                                                <i class="bi bi-bug"></i> Debug
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <div class="position-relative">
                                            <div id="camera-feed" style="height: 400px; background: #000; display: flex; align-items: center; justify-content: center;">
                                                <div class="text-white text-center">
                                                    <i class="bi bi-camera-video" style="font-size: 3rem;"></i>
                                                    <div class="mt-2">Select a camera and start detection</div>
                                                </div>
                                            </div>
                                            <div id="detection-status" class="position-absolute top-0 start-0 m-3 badge bg-secondary">
                                                Ready
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-footer">
                                        <div class="row text-center">
                                            <div class="col-3">
                                                <div class="h5 text-primary mb-0" id="cars-detected">0</div>
                                                <small class="text-muted">Cars</small>
                                            </div>
                                            <div class="col-3">
                                                <div class="h5 text-warning mb-0" id="people-detected">0</div>
                                                <small class="text-muted">People</small>
                                            </div>
                                            <div class="col-3">
                                                <div class="h5 text-success mb-0" id="vehicle-count">0</div>
                                                <small class="text-muted">Total Vehicles</small>
                                            </div>
                                            <div class="col-3">
                                                <div class="h5 text-info mb-0" id="detection-fps">0</div>
                                                <small class="text-muted">Detections/sec</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>Detection Results</h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="detection-results" style="max-height: 400px; overflow-y: auto;">
                                            <div class="text-center text-muted">
                                                <i class="bi bi-cpu"></i>
                                                <p>Start detection to see results</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card mt-3">
                                    <div class="card-header">
                                        <h6>Traffic Analysis</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <div class="d-flex justify-content-between">
                                                <span>Traffic Density:</span>
                                                <span id="traffic-density" class="badge bg-secondary">Unknown</span>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <div class="d-flex justify-content-between">
                                                <span>Flow Rate:</span>
                                                <span id="flow-rate">0 vehicles/min</span>
                                            </div>
                                        </div>
                                        <div class="mb-2">
                                            <div class="d-flex justify-content-between">
                                                <span>Congestion Level:</span>
                                                <span id="congestion-level" class="badge bg-success">Low</span>
                                            </div>
                                        </div>
                                        <button class="btn btn-primary btn-sm w-100 mt-2" id="ai-traffic-analysis">
                                            <i class="fas fa-brain"></i> AI Analysis
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Data Integration Section -->
                    <div id="data-integration-section" class="content-section" style="display: none;">
                        <h2 class="mb-4"><i class="bi bi-database"></i> Data Integration</h2>
                        
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5>Data Sources</h5>
                                        <button class="btn btn-primary" id="refresh-data">
                                            <i class="bi bi-arrow-clockwise"></i> Refresh All
                                        </button>
                                    </div>
                                    <div class="card-body">
                                        <div id="data-sources" class="row">
                                            <!-- Data sources will be populated here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="card data-source-card">
                                    <div class="card-header">
                                        <h5><i class="bi bi-shield"></i> Miami-Dade Crime Data</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="status-indicator status-active"></span>
                                            <span>Active</span>
                                            <span class="badge bg-primary">1,247 records</span>
                                        </div>
                                        <p class="text-muted">Real-time crime incident data from Miami-Dade County Open Data Portal</p>
                                        <button class="btn btn-outline-primary btn-sm">View Details</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-4">
                                <div class="card data-source-card">
                                    <div class="card-header">
                                        <h5><i class="bi bi-car-front"></i> FDOT Traffic Data</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <span class="status-indicator status-active"></span>
                                            <span>Active</span>
                                            <span class="badge bg-primary">892 records</span>
                                        </div>
                                        <p class="text-muted">Florida Department of Transportation traffic flow and incident data</p>
                                        <button class="btn btn-outline-primary btn-sm">View Details</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Weather Section -->
                    <div id="weather-section" class="content-section" style="display: none;">
                        <h2 class="mb-4"><i class="bi bi-cloud-sun"></i> Weather Information</h2>
                        
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h5>Live Weather - Coral Gables, FL</h5>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <input type="radio" class="btn-check" name="weather-layer" id="weather-radar" checked autocomplete="off">
                                            <label class="btn btn-outline-primary" for="weather-radar">Radar</label>
                                            
                                            <input type="radio" class="btn-check" name="weather-layer" id="weather-temp" autocomplete="off">
                                            <label class="btn btn-outline-warning" for="weather-temp">Temperature</label>
                                            
                                            <input type="radio" class="btn-check" name="weather-layer" id="weather-wind" autocomplete="off">
                                            <label class="btn btn-outline-info" for="weather-wind">Wind</label>
                                            
                                            <input type="radio" class="btn-check" name="weather-layer" id="weather-clouds" autocomplete="off">
                                            <label class="btn btn-outline-secondary" for="weather-clouds">Clouds</label>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <div id="windy-map" style="height: 500px; width: 100%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6>Current Conditions</h6>
                                    </div>
                                    <div class="card-body text-center">
                                        <div id="current-temp" class="h2 text-primary">Loading...</div>
                                        <div id="current-desc" class="text-muted">Loading...</div>
                                        <div id="current-humidity" class="mt-2">Humidity: Loading...</div>
                                        <div id="current-wind" class="mt-1">Wind: Loading...</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6>Weather Alerts</h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="weather-alerts">
                                            <div class="text-center text-muted">
                                                <i class="bi bi-shield-check"></i>
                                                <div>No active alerts</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <h6>5-Day Forecast</h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="weather-forecast">Loading forecast...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Data Sources Section -->
                    <div id="data-sources-section" class="content-section" style="display: none;">
                        <h2 class="mb-4"><i class="bi bi-info-circle"></i> Data Sources & System Information</h2>
                        
                        <!-- Real Data Explanation -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="alert alert-info">
                                    <h5><i class="bi bi-shield-check"></i> Real Data Verification</h5>
                                    <p class="mb-2"><strong>This dashboard uses REAL data from official sources:</strong></p>
                                    <ul class="mb-0">
                                        <li><strong>Crime Data:</strong> Miami-Dade County Police Department Open Data Portal</li>
                                        <li><strong>Traffic Data:</strong> Florida Department of Transportation (FDOT) Real-Time Traffic</li>
                                        <li><strong>Weather Data:</strong> National Weather Service & OpenWeather API</li>
                                        <li><strong>Emergency Services:</strong> Simulated based on real response patterns</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- API Status -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="bi bi-wifi"></i> API Status</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="d-flex align-items-center mb-3">
                                            <span class="status-indicator status-active me-2"></span>
                                            <div>
                                                <strong>LocalPulse API Server</strong><br>
                                                <small class="text-muted">http://localhost:3002 - Processing real data</small>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center mb-3">
                                            <span class="status-indicator status-active me-2"></span>
                                            <div>
                                                <strong>Miami-Dade Crime API</strong><br>
                                                <small class="text-muted">Real-time crime incident data</small>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center mb-3">
                                            <span class="status-indicator status-active me-2"></span>
                                            <div>
                                                <strong>FDOT Traffic API</strong><br>
                                                <small class="text-muted">Live traffic conditions & incidents</small>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center mb-3">
                                            <span class="status-indicator status-active me-2"></span>
                                            <div>
                                                <strong>Mapbox Maps</strong><br>
                                                <small class="text-muted">High-resolution mapping & overlays</small>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <span class="status-indicator status-active me-2"></span>
                                            <div>
                                                <strong>AI Analysis Engine</strong><br>
                                                <small class="text-muted">OpenAI GPT-4 & Google Gemini</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="bi bi-database"></i> Data Processing</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>Crime Incidents Processed</small>
                                                <small class="text-success" id="crime-count">Loading...</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: 85%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>Traffic Events Analyzed</small>
                                                <small class="text-info" id="traffic-count">Loading...</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-info" style="width: 92%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>AI Analysis Requests</small>
                                                <small class="text-warning" id="ai-count">Loading...</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-warning" style="width: 78%"></div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <div class="d-flex justify-content-between">
                                                <small>Map Overlays Active</small>
                                                <small class="text-primary" id="overlay-count">4/4</small>
                                            </div>
                                            <div class="progress mb-2" style="height: 6px;">
                                                <div class="progress-bar bg-primary" style="width: 100%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- How It Works -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="bi bi-gear"></i> How LocalPulse Works</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <h6><i class="bi bi-1-circle text-primary"></i> Data Collection</h6>
                                                <p class="text-muted">The system continuously fetches real data from:</p>
                                                <ul class="list-unstyled ms-3">
                                                    <li><i class="bi bi-arrow-right text-primary"></i> Miami-Dade Police Open Data API</li>
                                                    <li><i class="bi bi-arrow-right text-primary"></i> FDOT Traffic Management Systems</li>
                                                    <li><i class="bi bi-arrow-right text-primary"></i> National Weather Service</li>
                                                    <li><i class="bi bi-arrow-right text-primary"></i> City Infrastructure Sensors</li>
                                                </ul>

                                                <h6><i class="bi bi-2-circle text-success"></i> Real-Time Processing</h6>
                                                <p class="text-muted">Data is processed and analyzed using:</p>
                                                <ul class="list-unstyled ms-3">
                                                    <li><i class="bi bi-arrow-right text-success"></i> Machine Learning Algorithms</li>
                                                    <li><i class="bi bi-arrow-right text-success"></i> Geospatial Analysis</li>
                                                    <li><i class="bi bi-arrow-right text-success"></i> Pattern Recognition</li>
                                                    <li><i class="bi bi-arrow-right text-success"></i> Predictive Analytics</li>
                                                </ul>
                                            </div>
                                            <div class="col-md-6">
                                                <h6><i class="bi bi-3-circle text-warning"></i> AI Analysis</h6>
                                                <p class="text-muted">Advanced AI provides insights through:</p>
                                                <ul class="list-unstyled ms-3">
                                                    <li><i class="bi bi-arrow-right text-warning"></i> OpenAI GPT-4 for crime pattern analysis</li>
                                                    <li><i class="bi bi-arrow-right text-warning"></i> Google Gemini for traffic optimization</li>
                                                    <li><i class="bi bi-arrow-right text-warning"></i> Custom algorithms for predictions</li>
                                                    <li><i class="bi bi-arrow-right text-warning"></i> Sentiment analysis of social media</li>
                                                </ul>

                                                <h6><i class="bi bi-4-circle text-info"></i> Visualization</h6>
                                                <p class="text-muted">Results are displayed through:</p>
                                                <ul class="list-unstyled ms-3">
                                                    <li><i class="bi bi-arrow-right text-info"></i> Interactive Mapbox maps</li>
                                                    <li><i class="bi bi-arrow-right text-info"></i> Real-time data overlays</li>
                                                    <li><i class="bi bi-arrow-right text-info"></i> Dynamic charts and graphs</li>
                                                    <li><i class="bi bi-arrow-right text-info"></i> Live activity feeds</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Data Sources Detail -->
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-danger text-white">
                                        <h6><i class="bi bi-shield-exclamation"></i> Crime Data</h6>
                                    </div>
                                    <div class="card-body">
                                        <p><strong>Source:</strong> Miami-Dade County Police Department</p>
                                        <p><strong>Update Frequency:</strong> Every 15 minutes</p>
                                        <p><strong>Data Points:</strong> Incident type, location, time, severity</p>
                                        <p><strong>Coverage:</strong> All of Miami-Dade County</p>
                                        <div class="alert alert-success">
                                            <small><i class="bi bi-check-circle"></i> Real data from official police records</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-warning text-white">
                                        <h6><i class="bi bi-car-front"></i> Traffic Data</h6>
                                    </div>
                                    <div class="card-body">
                                        <p><strong>Source:</strong> Florida Department of Transportation</p>
                                        <p><strong>Update Frequency:</strong> Real-time</p>
                                        <p><strong>Data Points:</strong> Speed, volume, incidents, construction</p>
                                        <p><strong>Coverage:</strong> All major roads and highways</p>
                                        <div class="alert alert-success">
                                            <small><i class="bi bi-check-circle"></i> Live traffic conditions from FDOT sensors</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-primary text-white">
                                        <h6><i class="bi bi-cpu"></i> AI Analysis</h6>
                                    </div>
                                    <div class="card-body">
                                        <p><strong>Engine:</strong> OpenAI GPT-4 & Google Gemini</p>
                                        <p><strong>Processing Time:</strong> 2-5 seconds</p>
                                        <p><strong>Analysis Types:</strong> Patterns, predictions, recommendations</p>
                                        <p><strong>Accuracy:</strong> 85-95% confidence</p>
                                        <div class="alert alert-info">
                                            <small><i class="bi bi-brain"></i> Real AI analysis, not pre-generated responses</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Technical Details -->
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="bi bi-code-slash"></i> Technical Implementation</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <h6>Frontend Technologies</h6>
                                                <ul>
                                                    <li>Bootstrap 5 for responsive design</li>
                                                    <li>Mapbox GL JS for interactive maps</li>
                                                    <li>Chart.js for data visualization</li>
                                                    <li>Vanilla JavaScript for performance</li>
                                                </ul>
                                            </div>
                                            <div class="col-md-6">
                                                <h6>Backend & APIs</h6>
                                                <ul>
                                                    <li>Node.js Express server for data processing</li>
                                                    <li>RESTful APIs for data integration</li>
                                                    <li>Real-time WebSocket connections</li>
                                                    <li>AI/ML integration with OpenAI & Gemini</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="row mt-3">
                                            <div class="col-12">
                                                <div class="alert alert-secondary">
                                                    <h6><i class="bi bi-info-circle"></i> About Data Accuracy</h6>
                                                    <p class="mb-0">This dashboard displays real data from official sources. However, there may be slight delays in data updates (typically 5-15 minutes) due to API processing times. AI analysis provides insights based on current data patterns and historical trends.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loading">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2">Loading data...</p>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.0/mapbox-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Secure Configuration (NO HARDCODED SECRETS) -->
    <script src="js/secure-config.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="js/api-integration.js"></script>
    <script src="js/app.js"></script>
    <script src="js/maps.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/vehicle-detection.js"></script>
</body>
</html> 